#include "../root_macros/CMSStyle.C"

void plotExclusion() {
  CMSstyle();
  gStyle->SetOptStat(0);

  TMultiGraph *mg = new TMultiGraph("mg", ";M_{W'} (GeV);W'#rightarrowWZ Coupling");
  TCanvas* c1 = new TCanvas("c1");
  c1->SetLogy(1);

   float masses[15];
   masses[0] = 200;
   masses[1] = 250;
   masses[2] = 300;
   masses[3] = 400;
   masses[4] = 500;
   masses[5] = 600;
   masses[6] = 700;
   masses[7] = 800;
   masses[8] = 900;
   masses[9] = 1000;
   masses[10] = 1100;
   masses[11] = 1200;
   masses[12] = 1300;
   masses[13] = 1400;
   masses[14] = 1500;

   float masses2D[30];
   masses2D[0] = 200;
   masses2D[29] = 200;
   masses2D[1] = 250;
   masses2D[28] = 250;
   masses2D[2] = 300;
   masses2D[27] = 300;
   masses2D[3] = 400;
   masses2D[26] = 400;
   masses2D[4] = 500;
   masses2D[25] = 500;
   masses2D[5] = 600;
   masses2D[24] = 600;
   masses2D[6] = 700;
   masses2D[23] = 700;
   masses2D[7] = 800;
   masses2D[22] = 800;
   masses2D[8] = 900;
   masses2D[21] = 900;
   masses2D[9] = 1000;
   masses2D[20] = 1000;
   masses2D[10] = 1100;
   masses2D[19] = 1100;
   masses2D[11] = 1200;
   masses2D[18] = 1200;
   masses2D[12] = 1300;
   masses2D[17] = 1300;
   masses2D[13] = 1400;
   masses2D[16] = 1400;
   masses2D[14] = 1500;
   masses2D[15] = 1500;
   float exp[15];
   float obs[15];
   float exp1[30];
   float exp2[30];
   exp[0] = 0.264215943479;
   obs[0] = 0.282065707077;
   exp1[0] = 0.312007246017;
   exp1[29] = 0.223025763193;
   exp2[0] = 0.370944368682;
   exp2[29] = 0.148492548119;
   exp[1] = 0.237060101236;
   obs[1] = 0.280695410561;
   exp1[1] = 0.282169249912;
   exp1[28] = 0.223215675852;
   exp2[1] = 0.328534786233;
   exp2[28] = 0.157238514886;
   exp[2] = 0.206259204665;
   obs[2] = 0.206696415982;
   exp1[2] = 0.230393269394;
   exp1[27] = 0.154532185974;
   exp2[2] = 0.266594366488;
   exp2[27] = 0.0801383901359;
   exp[3] = 0.22049112174;
   obs[3] = 0.186227772389;
   exp1[3] = 0.253438610387;
   exp1[26] = 0.201592990257;
   exp2[3] = 0.300596634292;
   exp2[26] = 0.179707414859;
   exp[4] = 0.262310082085;
   obs[4] = 0.295770404982;
   exp1[4] = 0.341222687064;
   exp1[25] = 0.250662719428;
   exp2[4] = 0.410959733451;
   exp2[25] = 0.225541632516;
   exp[5] = 0.304106530858;
   obs[5] = 0.287189170541;
   exp1[5] = 0.387148368031;
   exp1[24] = 0.281550050435;
   exp2[5] = 0.458677531811;
   exp2[24] = 0.229175756851;
   exp[6] = 0.401634052109;
   obs[6] = 0.434137801121;
   exp1[6] = 0.473844085426;
   exp1[23] = 0.382357738179;
   exp2[6] = 0.557042602073;
   exp2[23] = 0.375986719156;
   exp[7] = 0.454663252512;
   obs[7] = 0.491941683135;
   exp1[7] = 0.587800504736;
   exp1[22] = 0.436453512208;
   exp2[7] = 0.692344445048;
   exp2[22] = 0.42339747199;
   exp[8] = 0.585923799562;
   obs[8] = 0.534843556361;
   exp1[8] = 0.687848756678;
   exp1[21] = 0.530180999278;
   exp2[8] = 0.832420715716;
   exp2[21] = 0.51568846516;
   exp[9] = 0.719949006319;
   obs[9] = 0.698466861591;
   exp1[9] = 0.822046459535;
   exp1[20] = 0.688359688579;
   exp2[9] = 1.02077350898;
   exp2[20] = 0.642366768883;
   exp[10] = 0.919459324481;
   obs[10] = 0.892386943489;
   exp1[10] = 1.07688893421;
   exp1[19] = 0.84488810897;
   exp2[10] = 1.27874039625;
   exp2[19] = 0.762112920597;
   exp[11] = 1.21681145439;
   obs[11] = 1.18692719813;
   exp1[11] = 1.42240875897;
   exp1[18] = 1.16124461468;
   exp2[11] = 1.68147178116;
   exp2[18] = 0.994180943541;
   exp[12] = 1.60265626168;
   obs[12] = 1.5933585645;
   exp1[12] = 1.8859661597;
   exp1[17] = 1.54603322374;
   exp2[12] = 2.23735362059;
   exp2[17] = 1.35130810168;
   exp[13] = 2.37610406827;
   obs[13] = 2.34728427484;
   exp1[13] = 2.47374311992;
   exp1[16] = 2.19252023379;
   exp2[13] = 3.06359351162;
   exp2[16] = 2.11053093925;
   exp[14] = 3.24549313148;
   obs[14] = 3.22767107997;
   exp1[14] = 3.38337952997;
   exp1[15] = 3.05127416795;
   exp2[14] = 4.17354458439;
   exp2[15] = 2.91773430822;

  TGraph* grExp = new TGraph(15, masses, exp);
  TGraph* grObs = new TGraph(15, masses, obs);
  TGraph* grExp1 = new TGraph(30, masses2D, exp1);
  TGraph* grExp2 = new TGraph(30, masses2D, exp2);

  grExp->SetLineColor(kBlack);
  grExp->SetMarkerColor(kBlack);
  grExp->SetLineStyle(kDashed);
  grObs->SetLineColor(kBlack);
  grObs->SetMarkerColor(kBlack);
  grObs->SetMarkerStyle(20);
  grExp1->SetFillStyle(1001);
  grExp1->SetFillColor(kYellow);
  grExp2->SetFillStyle(1001);
  grExp2->SetFillColor(kGreen);

  mg->Add(grExp2, "F");
  mg->Add(grExp1, "F");
  mg->Add(grExp,  "L");
  mg->Add(grObs,  "P");
  mg->SetMinimum(0.1);
  mg->SetMaximum(10.);
  mg->Draw("a");

  TLine* line = new TLine(200, 1, 1500, 1);
  line->Draw();

  TLegend* leg = new TLegend(0.2, 0.62, 0.58, 0.92);
  leg->SetTextSize(0.06);
  leg->AddEntry(grObs, "Obs. Limit", "p");
  leg->AddEntry(grExp, "Exp. Limit", "l");
  leg->AddEntry(grExp1, "Exp. #pm 1#sigma", "f");
  leg->AddEntry(grExp2, "Exp. #pm 2#sigma", "f");
  leg->AddEntry(line, "W'_{SSM}#rightarrowWZ Coupling", "l");
  leg->SetBorderSize(0);
  leg->SetFillColor(0);
  leg->Draw();

  TLatex latexLabel;
  latexLabel.SetNDC();
  latexLabel.SetTextSize(0.06);
  latexLabel.SetTextFont(132);
  latexLabel.DrawLatex(0.41, 0.96, "CMS Preliminary 2011");
  latexLabel.DrawLatex(0.72, 0.38, "#sqrt{s} = 7 TeV");
  latexLabel.DrawLatex(0.68, 0.25, Form("#intL dt = %.1f fb^{-1}",4.7));


  c1->RedrawAxis();
  c1->Print("wprimewz_limits.C");
  c1->Print("wprimewz_limits.pdf");
}
